<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Send link to Kura</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      body {
        background-color: #0f0f11;
        color: #e2e8f0;
      }
      .input-glow:focus {
        box-shadow: 0 0 15px rgba(139, 92, 246, 0.5);
      }
    </style>
  </head>
  <body class="h-screen flex items-center justify-center">
    <div
      class="w-full max-w-md p-6 bg-gray-900 rounded-xl shadow-2xl border border-gray-800"
    >
      <h1
        class="text-2xl font-bold mb-6 text-center bg-gradient-to-r from-purple-400 to-pink-600 text-transparent bg-clip-text"
      >
        Send link to automatically open
      </h1>

      <div class="space-y-4">
        <input
          type="text"
          id="urlInput"
          placeholder="Paste URL here..."
          class="w-full p-4 bg-gray-800 border border-gray-700 rounded-lg focus:outline-none focus:border-purple-500 input-glow transition-all text-white placeholder-gray-500"
          autofocus
        />

        <button
          id="sendBtn"
          class="w-full py-3 px-4 bg-purple-600 hover:bg-purple-700 rounded-lg font-medium transition-colors duration-200 transform active:scale-95"
        >
          Send
        </button>
      </div>

      <p
        id="status"
        class="mt-4 text-center text-sm text-gray-500 min-h-[20px] transition-all"
      ></p>
    </div>

    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
      import {
        getDatabase,
        ref,
        push,
        set,
      } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

      const _0x1a2b =
        "231b421d2279410f6e4a7a786a172a615d370f06006e1b1b0d04484e39010949670f1e7065223f1c757c6c047e06714f26137a15010c3e464c32231d39504d4f71105713221434504d06381f4f033e11765f4a1f2e504505291128490d0e245f065a6e14394d420f2a4141231e3c7a0301053f465405765f774a46032f5e4d1827037552561f2a1f40132a112d555740394640146216314b460f2a41411f235e3b564e4f67105404231a3d5a57242f101e543f15365d4f042559575b27052a580141694150193e113f5c6118285941026e4a7a4a46032f5e4d1827037552561f2a1c421f3e153a58500838464b042d173d17421d3b10085421152b4a420a225c4325291e3c5c51242f101e547549680f1a587d0517427d487a15010c3b426d126e4a7a0819547202124f79466f0a175c730853132e4a3d0e100f285145407e453b09120b2e00144329403a0a0141695f41173f052a5c4e0825466d126e4a7a7e0e23016311347a2a0273664f36";
      const _0x3c4d = "X9#mK2$vLp";

      function _0x5e6f(text, key) {
        let result = "";
        for (let i = 0; i < text.length; i += 2) {
          result += String.fromCharCode(
            parseInt(text.substr(i, 2), 16) ^
              key.charCodeAt((i / 2) % key.length),
          );
        }
        return result;
      }

      let firebaseConfig;
      try {
        firebaseConfig = JSON.parse(_0x5e6f(_0x1a2b, _0x3c4d));
      } catch (e) {
        console.error("Config Error");
      }

      const app = initializeApp(firebaseConfig);
      const db = getDatabase(app);

      const input = document.getElementById("urlInput");
      const btn = document.getElementById("sendBtn");
      const status = document.getElementById("status");

      async function sendLink() {
        const url = input.value.trim();
        if (!url) return;

        // Basic URL validation/fix
        let cleanUrl = url;
        if (!/^https?:\/\//i.test(cleanUrl)) {
          cleanUrl = "https://" + cleanUrl;
        }

        btn.disabled = true;
        btn.innerHTML = "Sending...";

        try {
          const linksRef = ref(db, "links");
          const newLinkRef = push(linksRef);
          await set(newLinkRef, {
            url: cleanUrl,
            timestamp: Date.now(),
          });

          status.textContent = "Sent!";
          status.className =
            "mt-4 text-center text-sm text-green-400 min-h-[20px]";
          input.value = "";

          setTimeout(() => {
            status.textContent = "";
            status.className =
              "mt-4 text-center text-sm text-gray-500 min-h-[20px]";
          }, 2000);
        } catch (error) {
          console.error(error);
          status.textContent = "Error sending link. Check console.";
          status.className =
            "mt-4 text-center text-sm text-red-400 min-h-[20px]";
        } finally {
          btn.disabled = false;
          btn.innerHTML = "Send to Kura";
          input.focus();
        }
      }

      btn.addEventListener("click", sendLink);
      input.addEventListener("keypress", (e) => {
        if (e.key === "Enter") sendLink();
      });
    </script>
  </body>
</html>
